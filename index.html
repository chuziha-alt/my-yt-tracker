<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YT Editor Workflow Pro - GitHub Deploy</title>
    <!-- 1. ÂÖàËºâÂÖ• CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 2. ËºâÂÖ• React (Ê†∏ÂøÉ) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- 3. ËºâÂÖ• Babel (ËΩâË≠ØÂô®) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- 4. ËºâÂÖ• Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <!-- 5. ËºâÂÖ• Lucide Core -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #0f0f0f; color: #e2e8f0; margin: 0; }
        #root { min-height: 100vh; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #1a1a1a; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #444; }
    </style>
</head>
<body>
    <div id="root">
        <div class="flex items-center justify-center h-screen">
            <div class="text-slate-500 animate-pulse font-mono uppercase tracking-widest text-sm">Initializing Master Workflow...</div>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        
        // Ëá™ÂÆöÁæ© Lucide ÂúñÊ®ôÁµÑ‰ª∂ÔºåËß£Ê±∫ÁÄèË¶ΩÂô®Á´ØÁõ∏ÂÆπÊÄßÂïèÈ°å
        const LucideIcon = ({ name, size = 20, color = "currentColor", strokeWidth = 2, className = "", fill = "none" }) => {
            const [svg, setSvg] = useState('');

            useEffect(() => {
                const iconName = name.toLowerCase().replace(/ /g, '-');
                const icon = window.lucide.icons[name] || window.lucide.icons[iconName];
                if (icon) {
                    const svgString = icon[2].map(tag => {
                        const attrs = Object.entries(tag[1]).map(([key, value]) => `${key}="${value}"`).join(' ');
                        return `<${tag[0]} ${attrs} />`;
                    }).join('');
                    
                    const fullSvg = `
                        <svg 
                            xmlns="http://www.w3.org/2000/svg" 
                            width="${size}" 
                            height="${size}" 
                            viewBox="0 0 24 24" 
                            fill="${fill}" 
                            stroke="${color}" 
                            stroke-width="${strokeWidth}" 
                            stroke-linecap="round" 
                            stroke-linejoin="round" 
                            class="${className}"
                        >
                            ${svgString}
                        </svg>
                    `;
                    setSvg(fullSvg);
                }
            }, [name, size, color, strokeWidth, className, fill]);

            return <span dangerouslySetInnerHTML={{ __html: svg }} className="inline-flex items-center justify-center" />;
        };

        const Icons = {
            Play: (p) => <LucideIcon name="play" {...p} />,
            Pause: (p) => <LucideIcon name="pause" {...p} />,
            Square: (p) => <LucideIcon name="square" {...p} />,
            Trash2: (p) => <LucideIcon name="trash-2" {...p} />,
            BarChart3: (p) => <LucideIcon name="bar-chart-3" {...p} />,
            Clock: (p) => <LucideIcon name="clock" {...p} />,
            DollarSign: (p) => <LucideIcon name="dollar-sign" {...p} />,
            Target: (p) => <LucideIcon name="target" {...p} />,
            ClipboardList: (p) => <LucideIcon name="clipboard-list" {...p} />,
            TrendingUp: (p) => <LucideIcon name="trending-up" {...p} />,
            AlertCircle: (p) => <LucideIcon name="alert-circle" {...p} />,
            Calendar: (p) => <LucideIcon name="calendar" {...p} />,
            Film: (p) => <LucideIcon name="film" {...p} />,
            CreditCard: (p) => <LucideIcon name="credit-card" {...p} />,
            FileText: (p) => <LucideIcon name="file-text" {...p} />,
            Bell: (p) => <LucideIcon name="bell" {...p} />,
            AlertTriangle: (p) => <LucideIcon name="alert-triangle" {...p} />,
            HeartPulse: (p) => <LucideIcon name="heart-pulse" {...p} />,
            MessageSquare: (p) => <LucideIcon name="message-square" {...p} />,
            Tag: (p) => <LucideIcon name="tag" {...p} />,
            History: (p) => <LucideIcon name="history" {...p} />,
            Download: (p) => <LucideIcon name="download" {...p} />,
            Copy: (p) => <LucideIcon name="copy" {...p} />
        };

        // --- Firebase ÈÖçÁΩÆ ---
        // Ë´ãÂú®Ê≠§ËôïÂ°´ÂÖ•ÊÇ®Ëá™Â∑±ÁöÑ Firebase Config JSON ‰ª•‰øùÂ≠òË≥áÊñô
        // ÊÇ®ÂèØ‰ª•Âæû Firebase Console -> Â∞àÊ°àË®≠ÂÆö -> Web App Áç≤Âèñ
        let firebaseConfig = {
            apiKey: "", 
            authDomain: "", 
            projectId: "", 
            storageBucket: "", 
            messagingSenderId: "", 
            appId: "" 
        };

        // Â¶ÇÊûúÂú®ÊàëÂÄëÁöÑÊ∏¨Ë©¶Áí∞Â¢ÉÔºåÂâáËá™ÂãïËÆÄÂèñÊ∏¨Ë©¶ÈÖçÁΩÆ
        if (typeof __firebase_config !== 'undefined') {
            firebaseConfig = JSON.parse(__firebase_config);
        }

        if (firebaseConfig.projectId) {
            firebase.initializeApp(firebaseConfig);
        }

        const auth = firebase.apps.length ? firebase.auth() : null;
        const db = firebase.apps.length ? firebase.firestore() : null;
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'yt-editor-pro-v2';

        const PHASES = [
            { id: 'rough', name: 'ÂàùÂâ™ A-Roll', color: '#3b82f6' },
            { id: 'subs', name: 'ÊïàÊûúÂ≠óÂèäÁâπÊïà', color: '#8b5cf6' },
            { id: 'audio', name: 'Èü≥Ê®ÇÈü≥Êïà', color: '#10b981' },
            { id: 'grading', name: 'Ë™øÂÖâÂ≠óÂπï', color: '#f59e0b' },
            { id: 'upload', name: 'Á∏ÆÂúñ‰∏äÂÇ≥', color: '#ec4899' },
            { id: 'revision', name: '‰øÆÊîπ', color: '#f43f5e' },
            { id: 'other', name: 'ÂÖ∂‰ªñ (Ë´ãË®ªË®ò)', color: '#64748b' }
        ];

        function App() {
            const [user, setUser] = useState(null);
            const [projects, setProjects] = useState([]);
            const [logs, setLogs] = useState([]);
            const [now, setNow] = useState(new Date());

            const [isRunning, setIsRunning] = useState(false);
            const [time, setTime] = useState(0);
            const [activeProjectId, setActiveProjectId] = useState('');
            const [activePhase, setActivePhase] = useState(PHASES[0].id);
            const [sessionNote, setSessionNote] = useState('');
            const [sessionStartTime, setSessionStartTime] = useState(null);
            const [showBreakAlert, setShowBreakAlert] = useState(false);

            const [newProject, setNewProject] = useState({ 
                name: '', client: '', estHours: 5, estIncome: 2000, cost: 0, 
                projectDate: new Date().toISOString().split('T')[0], deadline: '', notes: '' 
            });

            useEffect(() => {
                if (!auth) return;
                const unsubscribe = auth.onAuthStateChanged((u) => {
                    if (u) { setUser(u); } 
                    else { auth.signInAnonymously().catch(err => console.error("Auth error:", err)); }
                });
                return () => unsubscribe();
            }, []);

            useEffect(() => {
                const clockInterval = setInterval(() => setNow(new Date()), 1000);
                return () => clearInterval(clockInterval);
            }, []);

            useEffect(() => {
                if (!user || !db) return;
                const userPath = `artifacts/${appId}/users/${user.uid}`;
                const unsubProjects = db.collection(`${userPath}/projects`).onSnapshot(snap => {
                    setProjects(snap.docs.map(d => ({ id: d.id, ...d.data() })));
                });
                const unsubLogs = db.collection(`${userPath}/logs`).onSnapshot(snap => {
                    setLogs(snap.docs.map(d => ({ id: d.id, ...d.data() })));
                });
                return () => { unsubProjects(); unsubLogs(); };
            }, [user]);

            useEffect(() => {
                let interval;
                if (isRunning) {
                    interval = setInterval(() => {
                        setTime(prev => prev + 1);
                        if (time > 0 && (time + 1) % 3000 === 0) setShowBreakAlert(true);
                    }, 1000);
                }
                return () => clearInterval(interval);
            }, [isRunning, time]);

            const formatTime = (seconds) => {
                const h = Math.floor(seconds / 3600);
                const m = Math.floor((seconds % 3600) / 60);
                const s = seconds % 60;
                return `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            };

            const startTimer = () => {
                if (!activeProjectId) { alert("Ë´ãÂÖàÈÅ∏Êìá‰∏ÄÂÄãÂ∞àÊ°àÔºÅ"); return; }
                setIsRunning(true);
                if (!sessionStartTime) setSessionStartTime(new Date());
            };

            const stopTimer = async () => {
                if (time === 0 || !db || !user) return;
                setIsRunning(false);
                const endTime = new Date();
                const logData = {
                    projectId: activeProjectId,
                    phase: activePhase,
                    note: sessionNote,
                    seconds: time,
                    date: new Date().toISOString(),
                    timestamp: Date.now(),
                    displayStartTime: sessionStartTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                    displayEndTime: endTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                };
                try {
                    await db.collection(`artifacts/${appId}/users/${user.uid}/logs`).add(logData);
                    setTime(0); setSessionNote(''); setSessionStartTime(null);
                } catch (err) { console.error("Save log error:", err); }
            };

            const stats = useMemo(() => {
                if (!logs.length || !projects.length) return [];
                const res = projects.map(p => {
                    const pLogs = logs.filter(l => l.projectId === p.id);
                    const actualSeconds = pLogs.reduce((acc, curr) => acc + curr.seconds, 0);
                    const actualHours = actualSeconds / 3600;
                    const netIncome = (p.estIncome || 0) - (p.cost || 0);
                    const rawHourlyRate = actualHours > 0 ? netIncome / actualHours : 0;
                    const actualHourlyRate = Math.min(rawHourlyRate, p.estIncome || 0);
                    const efficiency = (actualHours / (p.estHours || 1)) * 100;
                    let daysLeft = p.deadline ? Math.ceil((new Date(p.deadline) - new Date()) / 86400000) : null;
                    const comment = efficiency > 120 ? "‚ö†Ô∏è Âö¥ÈáçË∂ÖÊôÇ" : efficiency > 105 ? "üßê Á®çÂæÆÊãñÊÖ¢" : efficiency < 85 ? "‚ú® ÊïàÁéáÊ•µ‰Ω≥" : "‚úÖ Á©©ÂÆö";
                    const phaseData = PHASES.map(ph => {
                        const phSec = pLogs.filter(l => l.phase === ph.id).reduce((a, c) => a + c.seconds, 0);
                        return { ...ph, percent: actualSeconds > 0 ? (phSec / actualSeconds) * 100 : 0 };
                    });
                    const recentWork = [...pLogs].sort((a,b) => b.timestamp - a.timestamp).slice(0, 3);
                    return { ...p, actualHours, actualHourlyRate, efficiency, comment, phaseData, daysLeft, netIncome, recentWork };
                });
                return res.sort((a, b) => new Date(b.projectDate) - new Date(a.projectDate));
            }, [logs, projects]);

            const todayHours = useMemo(() => {
                const today = new Date().toISOString().split('T')[0];
                const sec = logs.filter(l => l.date.startsWith(today)).reduce((a, b) => a + b.seconds, 0);
                return (sec / 3600).toFixed(1);
            }, [logs]);

            const exportCSV = () => {
                let csv = "Êó•Êúü,ÂÆ¢Êà∂,Â∞àÊ°à,Áí∞ÁØÄ,ËÄóÊôÇ(Áßí),ÂÇôË®ª,ÈñãÂßã,ÁµêÊùü\n";
                logs.forEach(log => {
                    const p = projects.find(proj => proj.id === log.projectId);
                    const ph = PHASES.find(ph => ph.id === log.phase)?.name;
                    csv += `${log.date.split('T')[0]},${p?.client || ''},${p?.name || ''},${ph},${log.seconds},${log.note || ''},${log.displayStartTime || ''},${log.displayEndTime || ''}\n`;
                });
                const blob = new Blob(["\uFEFF" + csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement("a");
                link.href = URL.createObjectURL(blob);
                link.setAttribute("download", `Editor_Logs_${new Date().toISOString().split('T')[0]}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };

            const copyNotionTable = () => {
                let table = "| Âü∑Ë°åÊó•Êúü | ÂÆ¢Êà∂ | Â∞àÊ°àÂêçÁ®± | ÂØ¶ÈöõÊôÇËñ™ | Á∏ΩÂ∑•ÊôÇ | Ë©ïË™û |\n| :--- | :--- | :--- | :--- | :--- | :--- |\n";
                stats.forEach(s => { table += `| ${s.projectDate} | ${s.client} | ${s.name} | $${Math.round(s.actualHourlyRate)}/h | ${s.actualHours.toFixed(1)}h | ${s.comment} |\n`; });
                const textArea = document.createElement("textarea");
                textArea.value = table; document.body.appendChild(textArea); textArea.select();
                document.execCommand('copy'); document.body.removeChild(textArea);
                alert("Â∑≤Ë§áË£Ω Notion Ë°®Ê†ºÊ†ºÂºèÔºÅ");
            };

            const addProject = async () => {
                if (!newProject.name || !newProject.client || !db) return;
                try {
                    await db.collection(`artifacts/${appId}/users/${user.uid}/projects`).add({...newProject, createdAt: new Date().toISOString()});
                    setNewProject({ name: '', client: '', estHours: 5, estIncome: 2000, cost: 0, projectDate: new Date().toISOString().split('T')[0], deadline: '', notes: '' });
                } catch (err) { console.error("Add project error:", err); }
            };

            return (
                <div className="min-h-screen text-slate-200 p-4 md:p-8">
                    <div className="max-w-6xl mx-auto space-y-6">
                        <header className="flex flex-col md:flex-row md:items-center justify-between gap-4 border-b border-white/10 pb-6">
                            <div>
                                <h1 className="text-2xl font-bold text-white flex items-center gap-2">
                                    <Icons.TrendingUp className="text-blue-400" /> YT Editor Workflow Pro
                                </h1>
                                <p className="text-slate-400 text-sm italic font-mono mt-1">
                                    {now.toLocaleDateString('zh-TW', { month: '2-digit', day: '2-digit', weekday: 'long' })} {now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' })}
                                </p>
                            </div>
                            <div className="flex gap-2">
                                <button onClick={copyNotionTable} className="flex items-center gap-2 px-3 py-2 bg-white/5 hover:bg-white/10 rounded-lg text-xs font-bold border border-white/10 transition-all text-slate-300">
                                    <Icons.Copy size={14}/> Ë§áË£ΩË°®Ê†º
                                </button>
                                <button onClick={exportCSV} className="flex items-center gap-2 px-3 py-2 bg-white/5 hover:bg-white/10 rounded-lg text-xs font-bold border border-white/10 transition-all text-slate-300">
                                    <Icons.Download size={14}/> Â∞éÂá∫ CSV
                                </button>
                            </div>
                        </header>

                        {showBreakAlert && (
                            <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-md p-4">
                                <div className="bg-[#1a1a1a] border-2 border-blue-500 rounded-3xl p-8 max-w-sm text-center shadow-2xl">
                                    <Icons.HeartPulse className="text-blue-500 mx-auto mb-4" size={48} />
                                    <h2 className="text-xl font-bold text-white mb-2">Ë©≤ÂñùÊ∞¥‰ºëÊÅØÂõâÔºÅ</h2>
                                    <p className="text-slate-400 text-sm mb-6">ÊÇ®Â∑≤ÈÄ£Á∫åÂâ™ËºØ 50 ÂàÜÈêò„ÄÇÁèæÂú®ÊòØ‰ºëÊÅØÊôÇÈñìÔºåË´ãËΩâÂãïËÇ©ËÜÄ‰∏¶ÈÅ†Áú∫Á™óÂ§ñ 20 Áßí„ÄÇ</p>
                                    <button onClick={() => setShowBreakAlert(false)} className="w-full py-3 bg-blue-600 hover:bg-blue-500 text-white rounded-xl font-bold transition-all">OKÔºåÈ¶¨‰∏äÂéªÂãï‰∏ÄÂãï</button>
                                </div>
                            </div>
                        )}

                        <div className="grid grid-cols-1 lg:grid-cols-12 gap-6">
                            <div className="lg:col-span-4 space-y-6">
                                <div className="bg-[#1a1a1a] rounded-2xl p-6 border border-white/5 shadow-xl">
                                    <div className="mb-4">
                                        <label className="text-[10px] font-bold text-slate-500 uppercase mb-2">Ê≠£Âú®Ââ™ËºØÂ∞àÊ°à</label>
                                        <select className="w-full bg-[#0a0a0a] border border-white/10 rounded-lg p-2.5 text-white outline-none focus:ring-1 ring-blue-500" value={activeProjectId} onChange={(e) => setActiveProjectId(e.target.value)} disabled={isRunning}>
                                            <option value="">-- ÈÅ∏ÊìáÂ∞àÊ°à --</option>
                                            {projects.map(p => <option key={p.id} value={p.id}>{p.client} | {p.name}</option>)}
                                        </select>
                                    </div>
                                    <div className="mb-4">
                                        <label className="text-[10px] font-bold text-slate-500 uppercase mb-2">Â∑•‰ΩúÁí∞ÁØÄ</label>
                                        <div className="grid grid-cols-2 gap-2">
                                            {PHASES.map(ph => (
                                                <button key={ph.id} onClick={() => setActivePhase(ph.id)} disabled={isRunning}
                                                    className={`text-[10px] py-2 px-1 rounded-md border transition-all ${activePhase === ph.id ? 'border-blue-500 bg-blue-500/10 text-blue-400' : 'border-white/5 bg-white/5 text-slate-400'}`}>
                                                    {ph.name}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                    <div className="mb-6">
                                        <label className="text-[10px] font-bold text-slate-500 uppercase flex items-center gap-1 mb-2"><Icons.MessageSquare size={12}/> Áí∞ÁØÄË®ªË®ò</label>
                                        <input type="text" placeholder="ÂÖ∑È´îÂÖßÂÆπ..." className="w-full bg-[#0a0a0a] border border-white/10 rounded-lg p-2 text-xs text-white" value={sessionNote} onChange={(e) => setSessionNote(e.target.value)} />
                                    </div>
                                    <div className="text-center py-6 bg-black/30 rounded-2xl mb-4 border border-white/5">
                                        {isRunning && sessionStartTime && (
                                            <div className="text-[10px] text-blue-400 mb-2 font-mono uppercase tracking-widest">
                                                Started at: {sessionStartTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                                            </div>
                                        )}
                                        <div className={`text-5xl font-mono font-bold ${isRunning ? 'text-white drop-shadow-[0_0_8px_rgba(59,130,246,0.4)]' : 'text-slate-600'}`}>{formatTime(time)}</div>
                                        <div className="mt-8 flex flex-col gap-3 px-4">
                                            {!isRunning ? (
                                                <button onClick={startTimer} className="w-full py-4 bg-blue-600 hover:bg-blue-500 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-all active:scale-95 shadow-lg shadow-blue-900/20">
                                                    <Icons.Play size={20} fill="currentColor"/> {time > 0 ? 'ÁπºÁ∫å' : 'ÈñãÂßã'}
                                                </button>
                                            ) : (
                                                <button onClick={() => setIsRunning(false)} className="w-full py-4 bg-slate-700 hover:bg-slate-600 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-all active:scale-95">
                                                    <Icons.Pause size={20} fill="currentColor"/> Êö´ÂÅú
                                                </button>
                                            )}
                                            {time > 0 && (
                                                <button onClick={stopTimer} className="text-red-400 text-xs font-bold hover:underline py-2">ÁµêÊùüÂ≠òÊ™î</button>
                                            )}
                                        </div>
                                    </div>
                                </div>
                                <div className="bg-[#1a1a1a] rounded-2xl p-6 border border-white/5">
                                    <h3 className="text-sm font-bold flex items-center gap-2 mb-4"><Icons.ClipboardList size={16}/> Êñ∞Â¢ûË®àÁï´</h3>
                                    <div className="space-y-3">
                                        <input type="text" placeholder="Ê®ôÈ°å" className="w-full bg-[#0a0a0a] border border-white/10 rounded-lg p-2 text-sm text-white" value={newProject.name} onChange={e => setNewProject({...newProject, name: e.target.value})} />
                                        <input type="text" placeholder="ÂÆ¢Êà∂" className="w-full bg-[#0a0a0a] border border-white/10 rounded-lg p-2 text-sm text-white" value={newProject.client} onChange={e => setNewProject({...newProject, client: e.target.value})} />
                                        <div className="grid grid-cols-2 gap-2 text-white">
                                            <input type="number" placeholder="Êî∂ÂÖ•" className="w-full bg-[#0a0a0a] border border-white/10 rounded-lg p-2 text-sm" value={newProject.estIncome} onChange={e => setNewProject({...newProject, estIncome: parseFloat(e.target.value) || 0})} />
                                            <input type="number" placeholder="ÊàêÊú¨" className="w-full bg-[#0a0a0a] border border-white/10 rounded-lg p-2 text-sm" value={newProject.cost} onChange={e => setNewProject({...newProject, cost: parseFloat(e.target.value) || 0})} />
                                        </div>
                                        <div className="grid grid-cols-2 gap-2 text-white">
                                            <div><label className="text-[10px] text-blue-400 font-bold uppercase tracking-tighter">Âü∑Ë°åÊó•</label><input type="date" className="w-full bg-[#0a0a0a] border border-white/10 rounded-lg p-2 text-xs" value={newProject.projectDate} onChange={e => setNewProject({...newProject, projectDate: e.target.value})} /></div>
                                            <div><label className="text-[10px] text-red-400 font-bold uppercase tracking-tighter">Êà™Á®øÊó•</label><input type="date" className="w-full bg-[#0a0a0a] border border-white/10 rounded-lg p-2 text-xs" value={newProject.deadline} onChange={e => setNewProject({...newProject, deadline: e.target.value})} /></div>
                                        </div>
                                        <input type="number" placeholder="È†êË®àÊôÇÊï∏ (h)" className="w-full bg-[#0a0a0a] border border-white/10 rounded-lg p-2 text-sm text-white" value={newProject.estHours} onChange={e => setNewProject({...newProject, estHours: parseFloat(e.target.value) || 0})} />
                                        <textarea placeholder="ÂÇôË®ª..." className="w-full bg-[#0a0a0a] border border-white/10 rounded-lg p-2 text-sm h-20 text-white resize-none" value={newProject.notes} onChange={e => setNewProject({...newProject, notes: e.target.value})} />
                                        <button onClick={addProject} className="w-full py-3 bg-white text-black rounded-xl text-sm font-bold hover:bg-slate-200 transition-all active:scale-95 shadow-lg">Êñ∞Â¢ûÂ∞àÊ°à</button>
                                    </div>
                                </div>
                            </div>

                            <div className="lg:col-span-8 space-y-6">
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 font-bold">
                                    <div className="bg-[#1a1a1a] p-5 rounded-2xl border border-white/5 shadow-lg">
                                        <div className="text-slate-500 text-xs uppercase mb-1 flex items-center gap-1 tracking-wider"><Icons.Clock size={14}/> Êú¨Êó•Â∑•ÊôÇ</div>
                                        <div className="text-3xl text-orange-400">{todayHours} <span className="text-sm">h</span></div>
                                    </div>
                                    <div className="bg-[#1a1a1a] p-5 rounded-2xl border border-white/5 shadow-lg">
                                        <div className="text-slate-500 text-xs uppercase mb-1 flex items-center gap-1 tracking-wider"><Icons.DollarSign size={14}/> Á∏ΩÊ∑®Âà©È†ê‰º∞</div>
                                        <div className="text-3xl text-green-400">${stats.reduce((a, b) => a + (b.netIncome || 0), 0).toLocaleString()}</div>
                                    </div>
                                    <div className="bg-[#1a1a1a] p-5 rounded-2xl border border-white/5 shadow-lg">
                                        <div className="text-slate-500 text-xs uppercase mb-1 flex items-center gap-1 tracking-wider"><Icons.BarChart3 size={14}/> Âπ≥ÂùáÊôÇËñ™</div>
                                        <div className="text-3xl text-blue-400">${stats.length > 0 ? Math.round(stats.reduce((a, b) => a + b.actualHourlyRate, 0) / stats.length) : 0}/h</div>
                                    </div>
                                </div>

                                <div className="space-y-4">
                                    <h2 className="text-lg font-bold flex items-center gap-2 text-white"><Icons.Target className="text-purple-400"/> Â∞àÊ°àÂàÜÊûêÂ†±Âëä</h2>
                                    {stats.length === 0 ? (
                                        <div className="bg-[#1a1a1a] p-20 rounded-3xl border border-dashed border-white/10 text-center text-slate-500 uppercase tracking-widest font-bold">No Projects Found</div>
                                    ) : (
                                        stats.map(p => (
                                            <div key={p.id} className="bg-[#1a1a1a] rounded-3xl border border-white/5 overflow-hidden shadow-2xl transition-all hover:border-white/10 p-6 mb-4">
                                                <div className="flex flex-col md:flex-row justify-between items-start gap-4 mb-4">
                                                    <div className="flex-1">
                                                        <div className="flex flex-wrap gap-2 mb-2 text-[10px] font-bold uppercase">
                                                            <span className="bg-blue-500/10 text-blue-400 px-2 py-0.5 rounded border border-blue-500/20">{p.client}</span>
                                                            <span className="bg-slate-800 text-slate-300 px-2 py-0.5 rounded tracking-tighter">ÂßãÊñº {p.projectDate}</span>
                                                            {p.deadline && <span className={`px-2 py-0.5 rounded ${p.daysLeft < 3 ? 'bg-red-500/20 text-red-400' : 'bg-orange-500/10 text-orange-400'}`}>Êà™Á®ø: {p.deadline} ({p.daysLeft}Â§©)</span>}
                                                        </div>
                                                        <h3 className="text-2xl font-bold text-white mb-2">{p.name}</h3>
                                                        {p.recentWork && p.recentWork.length > 0 && (
                                                            <div className="mb-4 bg-black/20 p-3 rounded-xl border border-white/5 space-y-1">
                                                                <div className="text-[10px] font-bold text-slate-500 uppercase flex items-center gap-1"><Icons.History size={12} /> ÊúÄËøë‰ΩúÊ•≠</div>
                                                                {p.recentWork.map((l, i) => (
                                                                    <div key={i} className="flex justify-between text-[11px] font-mono text-slate-400">
                                                                        <span>{PHASES.find(ph => ph.id === l.phase)?.name}: {l.displayStartTime} - {l.displayEndTime}</span>
                                                                        <span>{Math.round(l.seconds / 60)} min</span>
                                                                    </div>
                                                                ))}
                                                            </div>
                                                        )}
                                                        {p.notes && <div className="text-xs text-slate-400 italic bg-white/5 p-2 rounded flex gap-2"><Icons.FileText size={14}/> {p.notes}</div>}
                                                    </div>
                                                    <div className="text-right">
                                                        <div className={`text-2xl font-bold ${p.actualHourlyRate >= (p.estIncome/(p.estHours||1)) ? 'text-green-400' : 'text-orange-400'}`}>${Math.round(p.actualHourlyRate)}/h</div>
                                                        <div className="text-[10px] text-slate-500 font-bold uppercase">Ê∑®Âà©: ${p.netIncome.toLocaleString()}</div>
                                                        <div className="text-[9px] text-slate-600">Á∏ΩÊäïÂÖ•: {p.actualHours.toFixed(1)}h</div>
                                                    </div>
                                                </div>
                                                <div className="space-y-2 mb-6 text-xs font-bold">
                                                    <div className="flex justify-between"><span className="text-slate-500 uppercase tracking-wider">Usage Progress</span><span className={p.efficiency > 100 ? 'text-red-400' : 'text-blue-400'}>{p.efficiency.toFixed(0)}%</span></div>
                                                    <div className="w-full h-2 bg-white/5 rounded-full overflow-hidden"><div className={`h-full transition-all duration-700 ${p.efficiency > 100 ? 'bg-red-500' : 'bg-blue-500'}`} style={{ width: `${Math.min(p.efficiency, 100)}%` }} /></div>
                                                </div>
                                                <div className="grid grid-cols-7 gap-2 mb-6 overflow-x-auto pb-2">
                                                    {p.phaseData.map(ph => (
                                                        <div key={ph.id} className="text-center p-2 bg-black/20 rounded-lg border border-white/5 min-w-[75px]">
                                                            <div className="text-[8px] text-slate-500 uppercase truncate font-bold tracking-tighter">{ph.name}</div>
                                                            <div className="text-[10px] font-mono font-bold" style={{ color: ph.color }}>{ph.percent.toFixed(0)}%</div>
                                                        </div>
                                                    ))}
                                                </div>
                                                <div className="flex items-center gap-4 bg-black/40 p-4 rounded-2xl border border-white/5">
                                                    <Icons.AlertCircle size={20} className={p.efficiency > 105 ? 'text-orange-500' : 'text-blue-500'} />
                                                    <div className="flex-1"><div className="text-[10px] text-slate-500 uppercase font-bold tracking-wider">ÊïàÁéáË©ïË™û</div><div className="text-sm italic text-slate-300">"{p.comment}"</div></div>
                                                    <button onClick={async () => { if(confirm("Á¢∫ÂÆöË¶ÅÂà™Èô§Ê≠§Â∞àÊ°àÂèäÂÖ∂ÊâÄÊúâÊï∏ÊìöÂóéÔºü")) await db.collection(`artifacts/${appId}/users/${user.uid}/projects`).doc(p.id).delete(); }} className="text-slate-700 hover:text-red-500 transition-all p-2 active:scale-90"><Icons.Trash2 size={18} /></button>
                                                </div>
                                            </div>
                                        ))
                                    )}
                                </div>
                            </div>
                        </div>
                        <footer className="text-center py-12 border-t border-white/10 opacity-30 text-[10px] uppercase tracking-[3px]">
                            YT Editor Logic v2.7 - Standalone Final
                        </footer>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>